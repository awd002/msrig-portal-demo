{% extends "portal/base.html" %}
{% load widget_tweaks %}

{% block content %}

<!-- HERO HEADER -->
<div class="proposal-hero">
  <div class="hero-inner">

    <div class="hero-left">
      <h1 class="hero-title">{{ proposal.title }}</h1>

      <div class="hero-meta">
        <span class="badge-status badge-{{ proposal.status|lower }}">
          {{ proposal.get_status_display }}
        </span>

        {% for tag in proposal.tags.all %}
          <span class="tag-pill">{{ tag.name }}</span>
        {% endfor %}
      </div>
    </div>

    {% if proposal.status == "OPEN" %}
    <div class="hero-right">
      <a href="{% url 'proposal_signup' proposal.slug %}" class="btn-primary-lg">
        Sign Up for This Project
      </a>
    </div>
    {% endif %}

  </div>
</div>

<!-- MAIN CONTENT -->
<div class="proposal-container">

  <div class="proposal-grid">

    <!-- LEFT CONTENT -->
    <div class="proposal-main">

      <div class="content-card">

        <section>
          <h3>Summary</h3>
          <p>{{ proposal.summary|linebreaks }}</p>
        </section>

        <section>
          <h3>Background</h3>
          <p>{{ proposal.background|linebreaks }}</p>
        </section>

        <section>
          <h3>Aims</h3>
          <p>{{ proposal.aims|linebreaks }}</p>
        </section>

        {% if proposal.questions.exists %}
        <section>
          <h3>Application Questions</h3>
          <ul>
            {% for q in proposal.questions.all %}
              <li>{{ q.prompt }}</li>
            {% endfor %}
          </ul>
        </section>
        {% endif %}

        {% if proposal.status == "OPEN" %}
        <div class="bottom-cta">
          <a href="{% url 'proposal_signup' proposal.slug %}" class="btn-primary-lg">
            Sign Up for This Project
          </a>
        </div>
        {% endif %}

      </div>
    </div>

    <!-- SIDEBAR -->
    <div class="proposal-sidebar">

      <div class="sidebar-card">
        <h5>Principal Investigator</h5>
        <div class="pi-name">{{ proposal.created_by_name }}</div>
        <div class="pi-email">{{ proposal.created_by_email }}</div>
      </div>

      <div class="sidebar-card">
        <h5>Status</h5>
        <span class="badge-status badge-{{ proposal.status|lower }}">
          {{ proposal.get_status_display }}
        </span>
      </div>

      <div class="sidebar-card">
        <h5>Participation</h5>
        <div class="spots">
          {{ proposal.num_signups }} signups
        </div>
      </div>

    </div>

  </div>

</div>

{% endblock %}
